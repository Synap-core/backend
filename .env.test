# Synap Backend - Test Environment
# This file is automatically loaded by vitest
# Override production settings for safe testing

# =============================================================================
# DATABASE (Test Isolation)
# =============================================================================

# Use same database but with test- prefixed user IDs for isolation
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/synap

# Alternative: Separate test database (safer but requires setup)
# DATABASE_URL=postgresql://postgres:postgres@localhost:5432/synap_test

# =============================================================================
# AI / EMBEDDINGS (Test/Mock Keys)
# =============================================================================

# For unit tests: Use mock/deterministic embeddings
# For integration tests: Use real API with test key
OPENAI_API_KEY=test-key-for-embeddings
ANTHROPIC_API_KEY=test-key-for-claude

# Use deterministic embeddings in tests when possible
USE_MOCK_EMBEDDINGS=true

# =============================================================================
# REDIS (Test Instance)
# =============================================================================

REDIS_URL=redis://localhost:6379
REDIS_DB=1  # Use separate Redis DB for tests

# =============================================================================
# STORAGE (Test Bucket)
# =============================================================================

MINIO_BUCKET=synap-test
MINIO_ENDPOINT=localhost
MINIO_PORT=9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin
MINIO_USE_SSL=false

# =============================================================================
# APPLICATION (Test Ports)
# =============================================================================

NODE_ENV=test
LOG_LEVEL=warn  # Quieter logs in tests
LOG_PRETTY=false

# =============================================================================
# TESTING
# =============================================================================

# Disable external services in unit tests
DISABLE_INNGEST=true
DISABLE_REDIS=false  # Redis OK for tests
DISABLE_EXTERNAL_APIS=false  # Set to true for offline testing

# Test timeout
TEST_TIMEOUT=30000  # 30 seconds
